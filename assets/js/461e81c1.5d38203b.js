"use strict";(self.webpackChunkapache_teaclave_incubating=self.webpackChunkapache_teaclave_incubating||[]).push([[6698],{924:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>r,default:()=>p,frontMatter:()=>a,metadata:()=>i,toc:()=>l});const i=JSON.parse('{"id":"teaclave-sgx-sdk/documents/performance-optimization-tips","title":"Performance Optimization Tips","description":"Enable link time optimization","source":"@site/docs/teaclave-sgx-sdk/documents/performance-optimization-tips.md","sourceDirName":"teaclave-sgx-sdk/documents","slug":"/sgx-sdk-docs/performance-optimization-tips","permalink":"/sgx-sdk-docs/performance-optimization-tips","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"permalink":"/sgx-sdk-docs/performance-optimization-tips","slug":"/sgx-sdk-docs/performance-optimization-tips"}}');var s=t(1085),o=t(1184);const a={permalink:"/sgx-sdk-docs/performance-optimization-tips",slug:"/sgx-sdk-docs/performance-optimization-tips"},r="Performance Optimization Tips",c={},l=[{value:"Enable link time optimization",id:"enable-link-time-optimization",level:2},{value:"Let rustc emit asm",id:"let-rustc-emit-asm",level:2},{value:"Configure target_cpu for llvm",id:"configure-target_cpu-for-llvm",level:2},{value:"Enable lto on the final linking step",id:"enable-lto-on-the-final-linking-step",level:2}];function d(e){const n={code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",...(0,o.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"performance-optimization-tips",children:"Performance Optimization Tips"})}),"\n",(0,s.jsx)(n.h2,{id:"enable-link-time-optimization",children:"Enable link time optimization"}),"\n",(0,s.jsx)(n.p,{children:"This could boost CPU-intensive enclaves about 2~5% (on my 9900K)"}),"\n",(0,s.jsxs)(n.p,{children:["In ",(0,s.jsx)(n.code,{children:"Cargo.toml"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-toml",children:"[profile.release]\nlto = true\n"})}),"\n",(0,s.jsx)(n.h2,{id:"let-rustc-emit-asm",children:"Let rustc emit asm"}),"\n",(0,s.jsx)(n.p,{children:"This could boost enclaves on some platforms."}),"\n",(0,s.jsx)(n.p,{children:"Set an environment variable as"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'export RUSTFLAGS="--emit asm"\n'})}),"\n",(0,s.jsxs)(n.p,{children:["Or create a ",(0,s.jsx)(n.code,{children:".cargo/config"})," which covers your project as:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-toml",children:'[build]\nrustflags = ["--emit","asm"]\n'})}),"\n",(0,s.jsx)(n.h2,{id:"configure-target_cpu-for-llvm",children:"Configure target_cpu for llvm"}),"\n",(0,s.jsx)(n.p,{children:"This could boost enclaves on some platforms (not effective on my 9900K)."}),"\n",(0,s.jsx)(n.p,{children:"Set an environment variable as"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'export RUSTFLAGS="-C target-cpu=native"\n'})}),"\n",(0,s.jsxs)(n.p,{children:["Or create a ",(0,s.jsx)(n.code,{children:".cargo/config"})," which covers your project as:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-toml",children:'[build]\nrustflags = ["-C", "target-cpu=native"]\n'})}),"\n",(0,s.jsx)(n.h2,{id:"enable-lto-on-the-final-linking-step",children:"Enable lto on the final linking step"}),"\n",(0,s.jsxs)(n.p,{children:["Add ",(0,s.jsx)(n.code,{children:"-flto"})," to the final linking step using ",(0,s.jsx)(n.code,{children:"CXX"}),"."]})]})}function p(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},1184:(e,n,t)=>{t.d(n,{R:()=>a,x:()=>r});var i=t(4041);const s={},o=i.createContext(s);function a(e){const n=i.useContext(o);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),i.createElement(o.Provider,{value:n},e.children)}}}]);