"use strict";(self.webpackChunkapache_teaclave_incubating=self.webpackChunkapache_teaclave_incubating||[]).push([[1011],{1184:(e,a,t)=>{t.d(a,{R:()=>r,x:()=>c});var n=t(4041);const s={},i=n.createContext(s);function r(e){const a=n.useContext(i);return n.useMemo(function(){return"function"==typeof e?e(a):{...a,...e}},[a,e])}function c(e){let a;return a=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),n.createElement(i.Provider,{value:a},e.children)}},1387:(e,a,t)=>{t.r(a),t.d(a,{assets:()=>l,contentTitle:()=>c,default:()=>d,frontMatter:()=>r,metadata:()=>n,toc:()=>h});const n=JSON.parse('{"id":"teaclave/docs/release-guide","title":"Release Guide","description":"This document guide you through how to prepare and publish an official release.","source":"@site/docs/teaclave/docs/release-guide.md","sourceDirName":"teaclave/docs","slug":"/docs/release-guide","permalink":"/docs/release-guide","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"permalink":"/docs/release-guide","slug":"/docs/release-guide"},"sidebar":"teaclave_sidebar","previous":{"title":"Papers, Talks, and Related Articles","permalink":"/docs/papers-talks"},"next":{"title":"Development Tips","permalink":"/docs/development-tips"}}');var s=t(1085),i=t(1184);const r={permalink:"/docs/release-guide",slug:"/docs/release-guide"},c="Release Guide",l={},h=[{value:"Prepare the Release Notes",id:"prepare-the-release-notes",level:2},{value:"Prepare the GPG Signing Key",id:"prepare-the-gpg-signing-key",level:2},{value:"Cut a Release Candidate",id:"cut-a-release-candidate",level:2},{value:"Create Release Artifacts",id:"create-release-artifacts",level:2},{value:"Check the Artifacts",id:"check-the-artifacts",level:2},{value:"Upload the Release Candidate Artifacts",id:"upload-the-release-candidate-artifacts",level:2},{value:"Publish the Pre-Release on GitHub",id:"publish-the-pre-release-on-github",level:2},{value:"Call a Vote on the Release Candidate",id:"call-a-vote-on-the-release-candidate",level:2},{value:"Post the Release",id:"post-the-release",level:2},{value:"Update the Website",id:"update-the-website",level:2},{value:"Post the Announcement",id:"post-the-announcement",level:2}];function o(e){const a={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(a.header,{children:(0,s.jsx)(a.h1,{id:"release-guide",children:"Release Guide"})}),"\n",(0,s.jsx)(a.p,{children:"This document guide you through how to prepare and publish an official release.\nReleasing a new version in the community contains multiple steps, here is an\noverview."}),"\n",(0,s.jsx)(a.p,{children:"[[toc]]"}),"\n",(0,s.jsx)(a.h2,{id:"prepare-the-release-notes",children:"Prepare the Release Notes"}),"\n",(0,s.jsxs)(a.p,{children:["For a new release, you should first prepare the release note. Release note\ncontains summaries of new features, enhancements, bug fixes,\ndocs, known issues, and deprecation, etc. You can see the notes of\n",(0,s.jsx)(a.a,{href:"https://github.com/apache/incubator-teaclave/releases",children:"past release"})," as an example."]}),"\n",(0,s.jsx)(a.h2,{id:"prepare-the-gpg-signing-key",children:"Prepare the GPG Signing Key"}),"\n",(0,s.jsx)(a.p,{children:"You can skip this section if you have already uploaded your key. That is, the\nGPG signing key has been added in the following places:"}),"\n",(0,s.jsxs)(a.ul,{children:["\n",(0,s.jsxs)(a.li,{children:["The KEYS file in repo (",(0,s.jsx)(a.a,{href:"https://github.com/apache/incubator-teaclave/blob/master/KEYS",children:"https://github.com/apache/incubator-teaclave/blob/master/KEYS"}),")"]}),"\n",(0,s.jsxs)(a.li,{children:["Apache release dist sever (",(0,s.jsx)(a.a,{href:"https://dist.apache.org/repos/dist/release/incubator/teaclave/KEYS",children:"https://dist.apache.org/repos/dist/release/incubator/teaclave/KEYS"}),")"]}),"\n"]}),"\n",(0,s.jsx)(a.p,{children:"If you are the first to publish a release, please follow this instruction to\ngenerating and uplaoding keys."}),"\n",(0,s.jsxs)(a.p,{children:["To generate GPG key, please refer to\n",(0,s.jsx)(a.a,{href:"https://www.apache.org/dev/openpgp.html#generate-key",children:"https://www.apache.org/dev/openpgp.html#generate-key"})," for details."]}),"\n",(0,s.jsxs)(a.p,{children:["If you want to do the release on another machine, you can transfer your GPG key\nto that machine via the ",(0,s.jsx)(a.code,{children:"gpg --export"})," and ",(0,s.jsx)(a.code,{children:"gpg --import"})," commands."]}),"\n",(0,s.jsx)(a.p,{children:"The last step is to update the KEYS file with your code signing key. Check in\nthe changes to the main branch of the repository, as well as ASF SVN,"}),"\n",(0,s.jsx)(a.p,{children:"Here is an instruction of editing the KEYS file in the ASF SVN."}),"\n",(0,s.jsx)(a.pre,{children:(0,s.jsx)(a.code,{children:'# the --depth=files will avoid checkout existing folders\nsvn co --depth=files "https://dist.apache.org/repos/dist/dev/incubator/teaclave" svn-dev-teaclave\ncd svn-dev-teaclave\n# edit KEYS file\nsvn ci --username $ASF_USERNAME --password "$ASF_PASSWORD" -m "Update KEYS"\n# update downloads.apache.org\nsvn rm --username $ASF_USERNAME --password "$ASF_PASSWORD" https://dist.apache.org/repos/dist/release/incubator/teaclave/KEYS -m "Update KEYS"\nsvn cp --username $ASF_USERNAME --password "$ASF_PASSWORD" https://dist.apache.org/repos/dist/dev/incubator/teaclave/KEYS https://dist.apache.org/repos/dist/release/incubator/teaclave/ -m "Update KEYS"\n'})}),"\n",(0,s.jsx)(a.h2,{id:"cut-a-release-candidate",children:"Cut a Release Candidate"}),"\n",(0,s.jsxs)(a.p,{children:["To cut a release candidate, one needs to first cut a branch from the main branch\nusing selected version string. We follow the ",(0,s.jsx)(a.a,{href:"https://semver.org/",children:"semantic versioning"}),"\nguidelines for new version string. In short, x.y.z means MAJOR.MINOR.PATCH. Since we\nalready have the release note, we can decide the version string to be released\nbased on the changes."]}),"\n",(0,s.jsx)(a.p,{children:"Note that in our workflow, the main branch should be freezed during the\nreleasing period, i.e, no new features and enhancements can be merged into it.\nOnly changes on this release can be merged and committed into the releasing\nbranch."}),"\n",(0,s.jsxs)(a.p,{children:["For example, to release version 1.0.0, let us first create a new branch\n",(0,s.jsx)(a.code,{children:"release-v1.0.0"})," from the main branch."]}),"\n",(0,s.jsx)(a.pre,{children:(0,s.jsx)(a.code,{children:"git clone https://github.com/apache/incubator-teaclave\ncd incubator-teaclave\ngit checkout -b release-v1.0.0\n"})}),"\n",(0,s.jsx)(a.p,{children:"The next step is to do a complete version bumping (e.g., changing files which\ncontain versions and bump them from v0.9.0 to v1.0.0). Note that this affect\nmultiple files in different languages. Then, commit the changes to this\nreleasing branch. Other bug fixes and docs improvements can be also commited at\nthis time."}),"\n",(0,s.jsx)(a.p,{children:'When cleanups are done, make sure all tests can be passed. Then, add a tag with\nthe current commit in the form of "v1.0.0-rc.1" where 1 means it\'s the first\nrelease candidate. You can add the tag using git or add on GitHub.'}),"\n",(0,s.jsx)(a.p,{children:"Using Git:"}),"\n",(0,s.jsx)(a.pre,{children:(0,s.jsx)(a.code,{children:"git tag v1.0.0-rc.1\ngit push origin v1.0.0-rc.1\n"})}),"\n",(0,s.jsx)(a.h2,{id:"create-release-artifacts",children:"Create Release Artifacts"}),"\n",(0,s.jsx)(a.p,{children:"Create the source code artifacts, including a self-contained tarball without git\nhistory, a signature file signed by keys in the KEYS file, and a sha256 hash\nfile."}),"\n",(0,s.jsx)(a.pre,{children:(0,s.jsx)(a.code,{children:'git clone git@github.com:apache/incubator-teaclave.git apache-teaclave-1.0.0-rc.1-incubating\ncd apache-teaclave-1.0.0-rc.1-incubating\ngit checkout v1.0.0-rc.1\nmkdir build && cd build && cmake .. && cd ..    # This will init submodules and apply patches\nrm -rf build\nfind . -name ".git" -print0 | xargs -0 rm -rf   # Remove all .git directories\ncd ..\ntar czvf apache-teaclave-1.0.0-rc.1-incubating.tar.gz apache-teaclave-1.0.0-rc.1-incubating\n'})}),"\n",(0,s.jsx)(a.p,{children:"Use your GPG key to sign the created artifact. First make sure your GPG is set\nto use the correct private key,"}),"\n",(0,s.jsx)(a.pre,{children:(0,s.jsx)(a.code,{children:"$ gpg --list-key\n/home/user/.gnupg/pubring.kbx\n------------------------------------\npub   rsa4096 2020-08-17 [SC]\n      154xxx\nuid           [ unknown] XXX (CODE SIGNING KEY) <xxx@apache.org>\nsub   rsa4096 2020-08-17 [E]\n"})}),"\n",(0,s.jsx)(a.pre,{children:(0,s.jsx)(a.code,{children:"gpg -u 154xxx --armor --detach-sign apache-teaclave-1.0.0-rc.1-incubating.tar.gz\nsha512sum apache-teaclave-1.0.0-rc.1-incubating.tar.gz > apache-teaclave-1.0.0-rc.1-incubating.tar.gz.sha512\n"})}),"\n",(0,s.jsx)(a.p,{children:"At this point, we got three files in the release artifacts:"}),"\n",(0,s.jsxs)(a.ul,{children:["\n",(0,s.jsxs)(a.li,{children:[(0,s.jsx)(a.code,{children:"apache-teaclave-1.0.0-rc.1-incubating.tar.gz"}),": source code tarball"]}),"\n",(0,s.jsxs)(a.li,{children:[(0,s.jsx)(a.code,{children:"apache-teaclave-1.0.0-rc.1-incubating.tar.gz.asc"}),": signature"]}),"\n",(0,s.jsxs)(a.li,{children:[(0,s.jsx)(a.code,{children:"apache-teaclave-1.0.0-rc.1-incubating.tar.gz.sha512"}),": SHA512 hash"]}),"\n"]}),"\n",(0,s.jsx)(a.h2,{id:"check-the-artifacts",children:"Check the Artifacts"}),"\n",(0,s.jsxs)(a.p,{children:["We suggest to double check the release artifacts, e.g., verify the signature,\nhash value and build from scratch.\nThere is a ",(0,s.jsx)(a.a,{href:"https://cwiki.apache.org/confluence/display/INCUBATOR/Incubator+Release+Checklist",children:"checklist"})," which can help the process."]}),"\n",(0,s.jsx)(a.h2,{id:"upload-the-release-candidate-artifacts",children:"Upload the Release Candidate Artifacts"}),"\n",(0,s.jsx)(a.p,{children:"The release artifacts needs to be uploaded to ASF SVN,"}),"\n",(0,s.jsx)(a.pre,{children:(0,s.jsx)(a.code,{children:'# the --depth=files will avoid checkout existing folders\nsvn co --depth=files "https://dist.apache.org/repos/dist/dev/incubator/teaclave" svn-dev-teaclave\ncd svn-dev-teaclave\nmkdir 1.0.0-rc.1\n# copy files (.tar.gz, .asc, .sha512) into it\nsvn add 1.0.0-rc.1\nsvn ci --username $ASF_USERNAME --password "$ASF_PASSWORD" -m "Add 1.0.0-rc.1"\n'})}),"\n",(0,s.jsx)(a.h2,{id:"publish-the-pre-release-on-github",children:"Publish the Pre-Release on GitHub"}),"\n",(0,s.jsx)(a.p,{children:'The next step is to publish a pre-release. Go to the GitHub repo\'s "Releases"\ntab and click "Draft a new release".'}),"\n",(0,s.jsxs)(a.ul,{children:["\n",(0,s.jsx)(a.li,{children:"Choose a tag and select v1.0.0-rc.1."}),"\n",(0,s.jsx)(a.li,{children:"Copy and paste the release note draft into the description box."}),"\n",(0,s.jsx)(a.li,{children:'Select "This is a pre-release".'}),"\n",(0,s.jsx)(a.li,{children:"Upload the artifacts created by the previous steps."}),"\n",(0,s.jsx)(a.li,{children:'Click "Publish release".'}),"\n"]}),"\n",(0,s.jsx)(a.h2,{id:"call-a-vote-on-the-release-candidate",children:"Call a Vote on the Release Candidate"}),"\n",(0,s.jsxs)(a.p,{children:["There are two votes need to be done for releasing a incubating project.\nThe first vote takes place on the Apache Teaclave developers list\n(",(0,s.jsx)(a.code,{children:"dev@teaclave.apache.org"}),"). Once it is closed with pass, we can call for the\nsecond in the Apache Incubator general list\n(",(0,s.jsx)(a.code,{children:"general@incubator.apache.org"}),"). Look at past voting threads to see how this\nproceeds. The email should contains these information."]}),"\n",(0,s.jsxs)(a.ul,{children:["\n",(0,s.jsx)(a.li,{children:"Provide the link to the draft of the release notes in the email"}),"\n",(0,s.jsx)(a.li,{children:"Provide the link to the release candidate artifacts"}),"\n",(0,s.jsx)(a.li,{children:"Make sure the email is in text format and the links are correct"}),"\n"]}),"\n",(0,s.jsxs)(a.p,{children:["For the dev@ vote, there must be at least 3 binding +1 votes and more +1 votes\nthan -1 votes. Once the vote is done, you should also send out a summary email\nwith the totals, with a subject that looks something like ",(0,s.jsx)(a.code,{children:"[VOTE][RESULT]"}),"."]}),"\n",(0,s.jsx)(a.p,{children:"In ASF, votes are open at least 72hrs (3 days). If you don't get enough number\nof binding votes within that time, you cannot close the voting deadline. You\nneed to extend it."}),"\n",(0,s.jsx)(a.p,{children:"If the voting fails, the community needs to modified the release accordingly,\ncreate a new release candidate and re-run the voting process."}),"\n",(0,s.jsx)(a.p,{children:"Here are some examples:"}),"\n",(0,s.jsxs)(a.p,{children:[(0,s.jsx)(a.strong,{children:"Vote in the dev@teaclave list"}),":"]}),"\n",(0,s.jsxs)(a.ul,{children:["\n",(0,s.jsx)(a.li,{children:"subject: [VOTE] Release Apache Teaclave (incubating) v0.3.0-rc.1"}),"\n",(0,s.jsxs)(a.li,{children:["to: ",(0,s.jsx)(a.a,{href:"mailto:dev@teaclave.apache.org",children:"dev@teaclave.apache.org"})]}),"\n",(0,s.jsxs)(a.li,{children:["link: ",(0,s.jsx)(a.a,{href:"https://lists.apache.org/thread/9dzwv0y9l9qf9hol2rpwv85ns1xfgn7k",children:"https://lists.apache.org/thread/9dzwv0y9l9qf9hol2rpwv85ns1xfgn7k"})]}),"\n"]}),"\n",(0,s.jsxs)(a.p,{children:[(0,s.jsx)(a.strong,{children:"Result in the dev@teaclave list"}),":"]}),"\n",(0,s.jsxs)(a.ul,{children:["\n",(0,s.jsx)(a.li,{children:"subject: [RESULT][VOTE] Release Apache Teaclave (incubating) v0.3.0-rc.1"}),"\n",(0,s.jsxs)(a.li,{children:["to: ",(0,s.jsx)(a.a,{href:"mailto:dev@teaclave.apache.org",children:"dev@teaclave.apache.org"})]}),"\n",(0,s.jsxs)(a.li,{children:["link: ",(0,s.jsx)(a.a,{href:"https://lists.apache.org/thread/tyqhx2m9q0z1qg7dbxczf58nnpvxfzrn",children:"https://lists.apache.org/thread/tyqhx2m9q0z1qg7dbxczf58nnpvxfzrn"})]}),"\n"]}),"\n",(0,s.jsxs)(a.p,{children:[(0,s.jsx)(a.strong,{children:"Vote in the general@incubator list"}),":"]}),"\n",(0,s.jsxs)(a.ul,{children:["\n",(0,s.jsx)(a.li,{children:"subject: [VOTE] Release Apache Teaclave (incubating) v0.3.0-rc.1"}),"\n",(0,s.jsxs)(a.li,{children:["to: ",(0,s.jsx)(a.a,{href:"mailto:general@incubator.apache.org",children:"general@incubator.apache.org"})]}),"\n",(0,s.jsxs)(a.li,{children:["link: ",(0,s.jsx)(a.a,{href:"https://lists.apache.org/thread/mrwl41shgx60p432mw2lc6zcdw1lk6lk",children:"https://lists.apache.org/thread/mrwl41shgx60p432mw2lc6zcdw1lk6lk"})]}),"\n"]}),"\n",(0,s.jsxs)(a.p,{children:[(0,s.jsx)(a.strong,{children:"Result in the general@incubator list"}),":"]}),"\n",(0,s.jsxs)(a.ul,{children:["\n",(0,s.jsx)(a.li,{children:"subject: [RESULT][VOTE] Release Apache Teaclave (incubating) v0.3.0-rc.1"}),"\n",(0,s.jsxs)(a.li,{children:["to: ",(0,s.jsx)(a.a,{href:"mailto:general@teaclave.apache.org",children:"general@teaclave.apache.org"})]}),"\n",(0,s.jsxs)(a.li,{children:["link: ",(0,s.jsx)(a.a,{href:"https://lists.apache.org/thread/gbv3f7l9bf6t1876byqm1v4stsw7g00z",children:"https://lists.apache.org/thread/gbv3f7l9bf6t1876byqm1v4stsw7g00z"})]}),"\n"]}),"\n",(0,s.jsx)(a.h2,{id:"post-the-release",children:"Post the Release"}),"\n",(0,s.jsx)(a.p,{children:"After the vote passes, we need to crate the final release artifacts:"}),"\n",(0,s.jsx)(a.pre,{children:(0,s.jsx)(a.code,{children:'cd svn-dev-teaclave\nmkdir 1.0.0\n# copy RC files (.tar.gz, .asc, .sha512) into it and rename them\ncp 1.0.0-rc.1/apache-teaclave-1.0.0-rc.1-incubating.tar.gz 1.0.0/apache-teaclave-1.0.0-incubating.tar.gz\ncp 1.0.0-rc.1/apache-teaclave-1.0.0-rc.1-incubating.tar.gz.asc 1.0.0/apache-teaclave-1.0.0-incubating.tar.gz.asc\ncp 1.0.0-rc.1/apache-teaclave-1.0.0-rc.1-incubating.tar.gz.sha512 1.0.0/apache-teaclave-1.0.0-incubating.tar.gz.sha512\n# edit the file name (i.e., remove the rc version) in the sha512 file\nvi 1.0.0/apache-teaclave-1.0.0-incubating.tar.gz.sha512\nsvn add 1.0.0\nsvn ci --username $ASF_USERNAME --password "$ASF_PASSWORD" -m "Add 1.0.0"\n'})}),"\n",(0,s.jsx)(a.p,{children:"To upload the binaries to Apache mirrors, you copy the binaries from the dev\ndirectory (this should be where they are voted) to the dist directory.\nThese artifacts will be automatically propagated to the CDN service."}),"\n",(0,s.jsx)(a.pre,{children:(0,s.jsx)(a.code,{children:'export SVN_EDITOR=vim\nsvn cp https://dist.apache.org/repos/dist/dev/incubator/teaclave/1.0.0 https://dist.apache.org/repos/dist/release/incubator/teaclave/1.0.0\n\n# If you\'ve added your signing key to the KEYS file, also update the release copy.\nsvn co --depth=files "https://dist.apache.org/repos/dist/release/incubator/teaclave" svn-dist-teaclave\ncurl "https://dist.apache.org/repos/dist/dev/incubator/teaclave/KEYS" > svn-dist-teaclave/KEYS\n(cd svn-dist-teaclave && svn ci --username $ASF_USERNAME --password "$ASF_PASSWORD" -m "Update KEYS")\n'})}),"\n",(0,s.jsx)(a.p,{children:"Merge commits in the release branch to the main branch, create a new release tag\n(v1.0.0 in this case) on Github and remove the pre-release candidate tag."}),"\n",(0,s.jsx)(a.pre,{children:(0,s.jsx)(a.code,{children:"git checkout master\n## merge the release branch and use --ff-only to ensure the commit hash for voting is also in the master branch\ngit merge release-v1.0.0 --ff-only\ngit tag v1.0.0\ngit push origin v1.0.0\ngit push --delete origin v1.0.0-rc.1\ngit push --delete origin release-v1.0.0\n"})}),"\n",(0,s.jsx)(a.p,{children:"At last update the release notes and corresponding artifacts on GitHub."}),"\n",(0,s.jsx)(a.h2,{id:"update-the-website",children:"Update the Website"}),"\n",(0,s.jsxs)(a.p,{children:["The website repository is located at ",(0,s.jsx)(a.a,{href:"https://github.com/apache/incubator-teaclave-website",children:"https://github.com/apache/incubator-teaclave-website"}),".\nModify the download page to include the release artifacts as well as the GPG\nsignature and SHA hash. Note that only put the latest version in the download page.\nOlder releases are archived in the archive site automatically\n(",(0,s.jsx)(a.a,{href:"https://archive.apache.org/dist/incubator/teaclave/",children:"https://archive.apache.org/dist/incubator/teaclave/"}),")."]}),"\n",(0,s.jsxs)(a.p,{children:["Note that the links to the release artifact should start with\n",(0,s.jsx)(a.code,{children:"https://dlcdn.apache.org/incubator/teaclave"})," to better utilize the\nApache CND. You can refer to the previous release link."]}),"\n",(0,s.jsx)(a.h2,{id:"post-the-announcement",children:"Post the Announcement"}),"\n",(0,s.jsx)(a.p,{children:"Post new version release annoucement to the mailing list, blog and other\nchannels (Twitter, Discord, etc.)."}),"\n",(0,s.jsxs)(a.p,{children:[(0,s.jsx)(a.strong,{children:"Mailing list example"}),":"]}),"\n",(0,s.jsxs)(a.ul,{children:["\n",(0,s.jsx)(a.li,{children:"subject: [ANNOUNCE] Apache Teaclave (incubating) 0.3.0 released"}),"\n",(0,s.jsxs)(a.li,{children:["to: ",(0,s.jsx)(a.a,{href:"mailto:announce@apache.org",children:"announce@apache.org"}),", ",(0,s.jsx)(a.a,{href:"mailto:dev@teaclave.apache.org",children:"dev@teaclave.apache.org"})]}),"\n",(0,s.jsxs)(a.li,{children:["link: ",(0,s.jsx)(a.a,{href:"https://lists.apache.org/thread/frck6z5v135f8c7w64nkgqk86w1soqc7",children:"https://lists.apache.org/thread/frck6z5v135f8c7w64nkgqk86w1soqc7"})]}),"\n"]}),"\n",(0,s.jsxs)(a.p,{children:[(0,s.jsx)(a.strong,{children:"Blog example"}),":"]}),"\n",(0,s.jsxs)(a.ul,{children:["\n",(0,s.jsx)(a.li,{children:"title: Announcing Apache Teaclave (incubating) 0.3.0"}),"\n",(0,s.jsxs)(a.li,{children:["link: ",(0,s.jsx)(a.a,{href:"https://teaclave.apache.org/blog/2021-10-01-announcing-teaclave-0-3-0/",children:"https://teaclave.apache.org/blog/2021-10-01-announcing-teaclave-0-3-0/"})]}),"\n"]})]})}function d(e={}){const{wrapper:a}={...(0,i.R)(),...e.components};return a?(0,s.jsx)(a,{...e,children:(0,s.jsx)(o,{...e})}):o(e)}}}]);