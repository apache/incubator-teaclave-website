<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-teaclave/docs/my-first-function" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">My First Function | Apache Teaclave (incubating)</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://teaclave.apache.org/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://teaclave.apache.org/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://teaclave.apache.org/docs/my-first-function"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="My First Function | Apache Teaclave (incubating)"><meta data-rh="true" name="description" content="This documentation will guide you through executing your first function on the"><meta data-rh="true" property="og:description" content="This documentation will guide you through executing your first function on the"><link data-rh="true" rel="canonical" href="https://teaclave.apache.org/docs/my-first-function"><link data-rh="true" rel="alternate" href="https://teaclave.apache.org/docs/my-first-function" hreflang="en"><link data-rh="true" rel="alternate" href="https://teaclave.apache.org/docs/my-first-function" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"My First Function","item":"https://teaclave.apache.org/docs/my-first-function"}]}</script><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Apache Teaclave (incubating) RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Apache Teaclave (incubating) Atom Feed"><link rel="stylesheet" href="/assets/css/styles.c864e24f.css">
<script src="/assets/js/runtime~main.af65d8d3.js" defer="defer"></script>
<script src="/assets/js/main.fd7e90dd.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/img/logo.svg"><div role="region" aria-label="Skip to main content"><a class="skipToContent_G6ar" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="Apache Teaclave" class="themedComponent_DHUr themedComponent--light_DIHH" style="height:5.6rem;padding-left:1.6rem;position:relative;top:-1.8rem"><img src="/img/logo.svg" alt="Apache Teaclave" class="themedComponent_DHUr themedComponent--dark_Bv2M" style="height:5.6rem;padding-left:1.6rem;position:relative;top:-1.8rem"></div></a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/powered-by">Powered By</a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/community">Community</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/contributing">Contributing</a></li><li><a class="dropdown__link" href="/contributors">Contributors</a></li></ul></div><a class="navbar__item navbar__link" href="/download">Download</a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a aria-current="page" class="navbar__link active" aria-haspopup="true" aria-expanded="false" role="button" href="/docs">Docs</a><ul class="dropdown__menu"><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/docs/">Teaclave</a></li><li><a class="dropdown__link" href="/sgx-sdk-docs/">Teaclave SGX SDK</a></li><li><a class="dropdown__link" href="/trustzone-sdk-docs/">Teaclave TrustZone SDK</a></li><li><a href="https://teaclave.apache.org/api-docs/sgx-sdk/" target="_self" rel="" class="dropdown__link">Teaclave SGX SDK<svg width="12" height="12" aria-hidden="true" class="iconExternalLink_awgD"><use href="#theme-svg-external-link"></use></svg></a></li><li><a href="https://teaclave.apache.org/api-docs/trustzone-sdk/optee-teec" target="_self" rel="" class="dropdown__link">Teaclave TrustZone SDK (Host)<svg width="12" height="12" aria-hidden="true" class="iconExternalLink_awgD"><use href="#theme-svg-external-link"></use></svg></a></li><li><a href="https://teaclave.apache.org/api-docs/trustzone-sdk/optee-utee" target="_self" rel="" class="dropdown__link">Teaclave TrustZone SDK (TA)<svg width="12" height="12" aria-hidden="true" class="iconExternalLink_awgD"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><a class="navbar__item navbar__link" href="/blog">Blog</a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Repos</a><ul class="dropdown__menu"><li><a href="https://github.com/apache/incubator-teaclave" target="_blank" rel="noopener noreferrer" class="dropdown__link">Teaclave<svg width="12" height="12" aria-hidden="true" class="iconExternalLink_awgD"><use href="#theme-svg-external-link"></use></svg></a></li><li><a href="https://github.com/apache/incubator-teaclave-sgx-sdk" target="_blank" rel="noopener noreferrer" class="dropdown__link">Teaclave SGX SDK<svg width="12" height="12" aria-hidden="true" class="iconExternalLink_awgD"><use href="#theme-svg-external-link"></use></svg></a></li><li><a href="https://github.com/apache/incubator-teaclave-trustzone-sdk" target="_blank" rel="noopener noreferrer" class="dropdown__link">Teaclave TrustZone SDK<svg width="12" height="12" aria-hidden="true" class="iconExternalLink_awgD"><use href="#theme-svg-external-link"></use></svg></a></li><li><a href="https://github.com/apache/incubator-teaclave-java-tee-sdk" target="_blank" rel="noopener noreferrer" class="dropdown__link">Teaclave Java TEE SDK<svg width="12" height="12" aria-hidden="true" class="iconExternalLink_awgD"><use href="#theme-svg-external-link"></use></svg></a></li><li><a href="https://github.com/apache/incubator-teaclave-website" target="_blank" rel="noopener noreferrer" class="dropdown__link">Teaclave Website<svg width="12" height="12" aria-hidden="true" class="iconExternalLink_awgD"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">ASF</a><ul class="dropdown__menu"><li><a href="https://www.apache.org/" target="_blank" rel="noopener noreferrer" class="dropdown__link">ASF Homepage<svg width="12" height="12" aria-hidden="true" class="iconExternalLink_awgD"><use href="#theme-svg-external-link"></use></svg></a></li><li><a href="https://www.apache.org/licenses/" target="_blank" rel="noopener noreferrer" class="dropdown__link">License<svg width="12" height="12" aria-hidden="true" class="iconExternalLink_awgD"><use href="#theme-svg-external-link"></use></svg></a></li><li><a href="https://www.apache.org/foundation/sponsorship.html" target="_blank" rel="noopener noreferrer" class="dropdown__link">Sponsorship<svg width="12" height="12" aria-hidden="true" class="iconExternalLink_awgD"><use href="#theme-svg-external-link"></use></svg></a></li><li><a href="https://www.apache.org/security/" target="_blank" rel="noopener noreferrer" class="dropdown__link">Security<svg width="12" height="12" aria-hidden="true" class="iconExternalLink_awgD"><use href="#theme-svg-external-link"></use></svg></a></li><li><a href="https://privacy.apache.org/policies/privacy-policy-public.html" target="_blank" rel="noopener noreferrer" class="dropdown__link">Privacy<svg width="12" height="12" aria-hidden="true" class="iconExternalLink_awgD"><use href="#theme-svg-external-link"></use></svg></a></li><li><a href="https://www.apache.org/foundation/thanks.html" target="_blank" rel="noopener noreferrer" class="dropdown__link">Thanks<svg width="12" height="12" aria-hidden="true" class="iconExternalLink_awgD"><use href="#theme-svg-external-link"></use></svg></a></li><li><a href="https://www.apache.org/events/current-event.html" target="_blank" rel="noopener noreferrer" class="dropdown__link">Events<svg width="12" height="12" aria-hidden="true" class="iconExternalLink_awgD"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="toggle_OLSw colorModeToggle_Hg9V"><button class="clean-btn toggleButton_wYmb toggleButtonDisabled_vaDU" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_KEbZ lightToggleIcon_Sxwe"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_KEbZ darkToggleIcon_Yem1"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_KEbZ systemToggleIcon_txm5"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_bmvg"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_UyTV"><div class="docsWrapper_XLvK"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_z1FD" type="button"></button><div class="docRoot_HciC"><aside class="theme-doc-sidebar-container docSidebarContainer_e5ai"><div class="sidebarViewport_N8x0"><div class="sidebar_vJCc"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_qiME"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/docs/my-first-function">Try</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/my-first-function">My First Function</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/functions-in-python">Function in Python</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/builtin-functions">How to Add Built-in Functions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/azure-confidential-computing">Deploying Teaclave on Azure Confidential Computing VM</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/executing-wasm">Executing WebAssembly in Teaclave</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/inference-with-tvm">Inference Task with TVM in Teaclave</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/access-control">Design</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/release-guide">Contribute</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/codebase/attestation">Codebase</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a href="https://teaclave.apache.org/api-docs/sgx-sdk/" target="_blank" rel="noopener noreferrer" class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false">API References</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_namt"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_YAwJ"><div class="docItemContainer_Rv5Z"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_zCmv" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_JFrk"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Try</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">My First Function</span></li></ul></nav><div class="tocCollapsible_O_Qc theme-doc-toc-mobile tocMobile_tjDr"><button type="button" class="clean-btn tocCollapsibleButton_htYj">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>My First Function</h1></header>
<p>This documentation will guide you through executing your first function on the
Teaclave platform.</p>
<h2 class="anchor anchorWithStickyNavbar_fF9Z" id="prerequisites">Prerequisites<a href="#prerequisites" class="hash-link" aria-label="Direct link to Prerequisites" title="Direct link to Prerequisites">​</a></h2>
<p>To run Teaclave, a hardware with Intel SGX support is needed. You can
check with this list of <a href="https://github.com/ayeks/SGX-hardware" target="_blank" rel="noopener noreferrer">supported hardware</a>.
Note that you sometimes need to configure BIOS to enable SGX. Additionally, you
need to install driver and platform software to run SGX applications. If you are
using Azure confidential computing VM, please refer to <a href="/docs/azure-confidential-computing/">this document</a>.
Otherwise, let install SGX driver first.</p>
<div class="language-text codeBlockContainer_ZGJx theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_kX1v"><pre tabindex="0" class="prism-code language-text codeBlock_TAPP thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_AdAo"><span class="token-line" style="color:#393A34"><span class="token plain">$ wget https://download.01.org/intel-sgx/sgx-linux/2.11/distro/ubuntu18.04-server/sgx_linux_x64_driver_2.6.0_b0a445b.bin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ sudo ./sgx_linux_x64_driver_2.6.0_b0a445b.bin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ ls /dev/isgx    # Make sure you have the SGX device</span><br></span></code></pre></div></div>
<p>Then, install SGX architectural enclaves and quoting libraries for attestation.</p>
<div class="language-text codeBlockContainer_ZGJx theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_kX1v"><pre tabindex="0" class="prism-code language-text codeBlock_TAPP thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_AdAo"><span class="token-line" style="color:#393A34"><span class="token plain">$ sudo apt-get install libssl-dev libcurl4-openssl-dev libprotobuf-dev</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ echo &#x27;deb [arch=amd64] https://download.01.org/intel-sgx/sgx_repo/ubuntu bionic main&#x27; | sudo tee /etc/apt/sources.list.d/intel-sgx.list</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ wget -qO - https://download.01.org/intel-sgx/sgx_repo/ubuntu/intel-sgx-deb.key | sudo apt-key add -</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ sudo apt-get update &amp;&amp; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   sudo apt-get install libsgx-launch libsgx-urts libsgx-epid libsgx-urts libsgx-quote-ex  libsgx-aesm-quote-ex-plugin libsgx-aesm-epid-plugin</span><br></span></code></pre></div></div>
<p>For more details, you can learn from
<a href="https://download.01.org/intel-sgx/sgx-linux/2.9/docs/Intel_SGX_Installation_Guide_Linux_2.9_Open_Source.pdf" target="_blank" rel="noopener noreferrer">Intel SGX Installation Guide</a>.</p>
<p>Docker and Docker Compose are also needed for building and trying Teaclave.</p>
<div class="language-text codeBlockContainer_ZGJx theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_kX1v"><pre tabindex="0" class="prism-code language-text codeBlock_TAPP thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_AdAo"><span class="token-line" style="color:#393A34"><span class="token plain">$ curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add -</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ sudo add-apt-repository \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   &quot;deb [arch=amd64] https://download.docker.com/linux/ubuntu \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   $(lsb_release -cs) \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   stable&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ sudo apt-get update &amp;&amp; sudo apt-get install docker-ce docker-ce-cli containerd.io</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ sudo usermod -aG docker your-user-name</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ sudo curl -L &quot;https://github.com/docker/compose/releases/download/1.27.4/docker-compose-$(uname -s)-$(uname -m)&quot; -o /usr/local/bin/docker-compose</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ sudo chmod +x /usr/local/bin/docker-compose</span><br></span></code></pre></div></div>
<p>If you don&#x27;t have an SGX supported hardware at hand, Teaclave can also run in
simulation mode. However some functions like remote attestation will be disabled
in this mode. Please start from <a href="#simulation-mode">here</a> if you plan to try in
simulation mode.</p>
<h2 class="anchor anchorWithStickyNavbar_fF9Z" id="clone-and-build-teaclave">Clone and Build Teaclave<a href="#clone-and-build-teaclave" class="hash-link" aria-label="Direct link to Clone and Build Teaclave" title="Direct link to Clone and Build Teaclave">​</a></h2>
<p>Clone the Teaclave repository:</p>
<div class="language-text codeBlockContainer_ZGJx theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_kX1v"><pre tabindex="0" class="prism-code language-text codeBlock_TAPP thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_AdAo"><span class="token-line" style="color:#393A34"><span class="token plain">$ git clone https://github.com/apache/incubator-teaclave.git</span><br></span></code></pre></div></div>
<p>Since the building dependencies are a bit complicated, we suggest to build the
Teaclave platform with our docker images. You can learn more details about the
building environment from <code>Dockerfile</code> under the <a href="/docker"><code>docker</code></a>
directory.</p>
<p>Build the Teaclave platform using docker:</p>
<div class="language-text codeBlockContainer_ZGJx theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_kX1v"><pre tabindex="0" class="prism-code language-text codeBlock_TAPP thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_AdAo"><span class="token-line" style="color:#393A34"><span class="token plain">$ cd incubator-teaclave</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ docker run --rm -v $(pwd):/teaclave -w /teaclave \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -it teaclave/teaclave-build-ubuntu-1804-sgx-2.17.1:0.2.0 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   bash -c &quot;. /root/.cargo/env &amp;&amp; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     . /opt/sgxsdk/environment &amp;&amp; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     mkdir -p build &amp;&amp; cd build &amp;&amp; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     cmake -DTEST_MODE=ON .. &amp;&amp; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     make -j&quot;</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_fF9Z" id="setup-attestation-service">Setup Attestation Service<a href="#setup-attestation-service" class="hash-link" aria-label="Direct link to Setup Attestation Service" title="Direct link to Setup Attestation Service">​</a></h2>
<p>For simplicity, we use Intel Attestation Service (IAS) in this tutorial. To get
started, you need to enroll in Intel SGX Attestation Service in
Intel&#x27;s <a href="https://api.portal.trustedservices.intel.com/EPID-attestation" target="_blank" rel="noopener noreferrer">attestation service portal</a>
by subscribing the attestation service for development (linkable is preferred).
Then, you can find &quot;SPID&quot; and &quot;Primary key&quot; in the subscription details for
later usage.</p>
<p>There is one more setup if you are using linkable attestation service subscription.
Edit the <code>/etc/aesmd.conf</code> file and uncomment
the <code>default quoting type = epid_linkable</code> line to enable linkable quotes for EPID-based attestation service
(i.e., Intel Attestation Service). At last, the AESM service needs to be restarted by
<code>sudo systemctl restart aesmd</code>.</p>
<div class="language-text codeBlockContainer_ZGJx theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_kX1v"><pre tabindex="0" class="prism-code language-text codeBlock_TAPP thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_AdAo"><span class="token-line" style="color:#393A34"><span class="token plain">$ sudo sed -i &#x27;/^#default quoting type = epid_linkable/s/^#//&#x27; /etc/aesmd.conf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ sudo service aesmd restart</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_fF9Z" id="launch-teaclave-services">Launch Teaclave Services<a href="#launch-teaclave-services" class="hash-link" aria-label="Direct link to Launch Teaclave Services" title="Direct link to Launch Teaclave Services">​</a></h2>
<p>Teaclave contains multiple services. To ease the deployment, you can use
<a href="https://docs.docker.com/compose/" target="_blank" rel="noopener noreferrer">docker-compose</a> to manage all services in a
containerized environment.</p>
<p>Setup environment variables:</p>
<div class="language-text codeBlockContainer_ZGJx theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_kX1v"><pre tabindex="0" class="prism-code language-text codeBlock_TAPP thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_AdAo"><span class="token-line" style="color:#393A34"><span class="token plain">$ export AS_SPID=&quot;00000000000000000000000000000000&quot;  # SPID from IAS subscription</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ export AS_KEY=&quot;00000000000000000000000000000000&quot;   # Primary key/Secondary key from IAS subscription</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ export AS_ALGO=&quot;sgx_epid&quot;                          # Attestation algorithm, sgx_epid for IAS</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ export AS_URL=&quot;https://api.trustedservices.intel.com:443&quot;    # IAS URL</span><br></span></code></pre></div></div>
<p>Launch all services with <code>docker-compose</code>:</p>
<div class="language-text codeBlockContainer_ZGJx theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_kX1v"><pre tabindex="0" class="prism-code language-text codeBlock_TAPP thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_AdAo"><span class="token-line" style="color:#393A34"><span class="token plain">$ (cd docker &amp;&amp; ./run-teaclave-services.sh)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Starting teaclave-authentication-service ... done</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Starting teaclave-access-control-service ... done</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Starting teaclave-scheduler-service      ... done</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Starting teaclave-management-service     ... done</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Starting teaclave-execution-service      ... done</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Starting teaclave-frontend-service       ... done</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Attaching to ...</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_fF9Z" id="invoke-function">Invoke Function<a href="#invoke-function" class="hash-link" aria-label="Direct link to Invoke Function" title="Direct link to Invoke Function">​</a></h2>
<p>We provide several examples to demonstrate the platform. Let&#x27;s get started with
invoking a built-in function: ordered-set-intersect, which is a function that
takes two ordered sets and returns the intersection set in the output files.
This function is a kind of
<a href="https://en.wikipedia.org/wiki/Private_set_intersection" target="_blank" rel="noopener noreferrer">PSI</a> implementation
based on TEE.</p>
<p>This example is written in Python, and some dependencies are needed for the
remote attestation. They can be installed with <code>pip</code>:</p>
<div class="language-text codeBlockContainer_ZGJx theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_kX1v"><pre tabindex="0" class="prism-code language-text codeBlock_TAPP thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_AdAo"><span class="token-line" style="color:#393A34"><span class="token plain">$ pip3 install pyopenssl toml cryptography grpcio grpcio-tools grpclib</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_fF9Z" id="built-in-function">Built-in function<a href="#built-in-function" class="hash-link" aria-label="Direct link to Built-in function" title="Direct link to Built-in function">​</a></h3>
<p>Then, run the PSI example:</p>
<div class="language-text codeBlockContainer_ZGJx theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_kX1v"><pre tabindex="0" class="prism-code language-text codeBlock_TAPP thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_AdAo"><span class="token-line" style="color:#393A34"><span class="token plain">$ cd examples/python</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ PYTHONPATH=../../sdk/python python3 builtin_ordered_set_intersect.py </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[+] user0 login</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[+] user1 login</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[+] user0 registering function</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[+] user0 creating task</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[+] user0 registering input file</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[+] user0 registering output file</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[+] user0 assigning data to task</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[+] user1 registering input file</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[+] user1 registering output file</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[+] user1 assigning data to task</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[+] user0 approving task</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[+] user1 approving task</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[+] user0 invoking task</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[+] user0 getting task result</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[+] user1 getting task result</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[+] User 0 result: 3 common items</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[+] User 1 result: 3 common items</span><br></span></code></pre></div></div>
<p>If you see above log, this means that the function is successfully invoked in
Teaclave. The intersection set is stored in the output files that the users registered.</p>
<h3 class="anchor anchorWithStickyNavbar_fF9Z" id="define-my-own-function">Define my own function<a href="#define-my-own-function" class="hash-link" aria-label="Direct link to Define my own function" title="Direct link to Define my own function">​</a></h3>
<p>The previous example is to demonstrate invoking the built-in PSI function. In
Teaclave, you can also register and invoke a function written by yourself. For
example, we have implemented a <a href="https://en.wikipedia.org/wiki/Logistic_regression" target="_blank" rel="noopener noreferrer">logistic
regression</a> function in
Python in
<a href="/assets/files/mesapy_logistic_reg_payload-ddd2cec56d45e67f04013ee7114d711f.py" target="_blank">mesapy_logistic_reg_payload.py</a>.
It can conduct both training and prediction.</p>
<p>Then run the mesapy LR example:</p>
<div class="language-text codeBlockContainer_ZGJx theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_kX1v"><pre tabindex="0" class="prism-code language-text codeBlock_TAPP thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_AdAo"><span class="token-line" style="color:#393A34"><span class="token plain">$ PYTHONPATH=../../sdk/python python3 mesapy_logistic_reg.py</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[+] mesapy_logistic_reg_train_task begin!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[+] admin login</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[+] admin registering function</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[+] admin reading payload file</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[+] admin creating task</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[+] admin registering input file</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[+] admin registering output file</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[+] admin assigning data to task</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[+] admin invoking task</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[+] admin getting task result</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[+] User 0 result: Training is finished!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[+] mesapy_logistic_reg_predict_task begin!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[+] admin registering function</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[+] admin reading payload file</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[+] admin creating task</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[+] admin getting task output</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[+] admin getting task output</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[+] admin registering input file</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[+] admin registering output file</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[+] admin assigning data to task</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[+] admin invoking task</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[+] admin getting task result</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[+] Predict result: [1.0 1.0 0.0 0.0 0.0]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[+] logistic_reg_task end!</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_fF9Z" id="simulation-mode">Simulation Mode<a href="#simulation-mode" class="hash-link" aria-label="Direct link to Simulation Mode" title="Direct link to Simulation Mode">​</a></h2>
<p>Clone and build Teaclave (with the <code>-DSGX_SIM_MODE=ON</code> option in <code>cmake</code>).
Note that if you are using Docker for Mac,
<a href="https://docs.docker.com/docker-for-mac/" target="_blank" rel="noopener noreferrer">increase the size of allocated memory</a> to
avoid compilation error caused by out-of-memory, e.g., reporting a &quot;signal: 9,
SIGKILL: kill&quot; error during the compilation.</p>
<div class="language-text codeBlockContainer_ZGJx theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_kX1v"><pre tabindex="0" class="prism-code language-text codeBlock_TAPP thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_AdAo"><span class="token-line" style="color:#393A34"><span class="token plain">$ git clone https://github.com/apache/incubator-teaclave.git</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ cd incubator-teaclave</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ docker run --rm -v $(pwd):/teaclave -w /teaclave \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -it teaclave/teaclave-build-ubuntu-1804-sgx-2.17.1:0.2.0 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   bash -c &quot;. /root/.cargo/env &amp;&amp; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     . /opt/sgxsdk/environment &amp;&amp; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     mkdir -p build &amp;&amp; cd build &amp;&amp; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     cmake -DTEST_MODE=ON -DSGX_SIM_MODE=ON .. &amp;&amp; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     make -j&quot;</span><br></span></code></pre></div></div>
<p>Since the attestation is disabled in the simulation mode, related environment
variables can be set to any values.</p>
<div class="language-text codeBlockContainer_ZGJx theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_kX1v"><pre tabindex="0" class="prism-code language-text codeBlock_TAPP thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_AdAo"><span class="token-line" style="color:#393A34"><span class="token plain">$ export AS_SPID=&quot;00000000000000000000000000000000&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ export AS_KEY=&quot;00000000000000000000000000000000&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ export AS_ALGO=&quot;sgx_epid&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ export AS_URL=&quot;https://api.trustedservices.intel.com:443&quot;</span><br></span></code></pre></div></div>
<p>At last, launch all services with <code>docker-compose</code>:</p>
<div class="language-text codeBlockContainer_ZGJx theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_kX1v"><pre tabindex="0" class="prism-code language-text codeBlock_TAPP thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_AdAo"><span class="token-line" style="color:#393A34"><span class="token plain">$ (cd docker &amp;&amp; ./run-teaclave-services.sh -m sim)</span><br></span></code></pre></div></div>
<p>In simulation mode, run the echo example with <code>SGX_MODE=SW</code> environment variable.</p>
<div class="language-text codeBlockContainer_ZGJx theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_kX1v"><pre tabindex="0" class="prism-code language-text codeBlock_TAPP thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_AdAo"><span class="token-line" style="color:#393A34"><span class="token plain">$ cd examples/python</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ SGX_MODE=SW PYTHONPATH=../../sdk/python python3 builtin_echo.py &#x27;Hello, Teaclave!&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[+] registering user</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[+] login</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[+] registering function</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[+] creating task</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[+] approving task</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[+] invoking task</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[+] getting result</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[+] done</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[+] function return:  b&#x27;Hello, Teaclave!&#x27;</span><br></span></code></pre></div></div></div></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--next" href="/docs/functions-in-python"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Function in Python</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_TN1Q thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#prerequisites" class="table-of-contents__link toc-highlight">Prerequisites</a></li><li><a href="#clone-and-build-teaclave" class="table-of-contents__link toc-highlight">Clone and Build Teaclave</a></li><li><a href="#setup-attestation-service" class="table-of-contents__link toc-highlight">Setup Attestation Service</a></li><li><a href="#launch-teaclave-services" class="table-of-contents__link toc-highlight">Launch Teaclave Services</a></li><li><a href="#invoke-function" class="table-of-contents__link toc-highlight">Invoke Function</a><ul><li><a href="#built-in-function" class="table-of-contents__link toc-highlight">Built-in function</a></li><li><a href="#define-my-own-function" class="table-of-contents__link toc-highlight">Define my own function</a></li></ul></li><li><a href="#simulation-mode" class="table-of-contents__link toc-highlight">Simulation Mode</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright"><div style="font-size:.7rem; text-align:left;">Apache Teaclave (incubating) is an effort undergoing incubation at The Apache Software Foundation (ASF), sponsored by the Apache Incubator. Incubation is required of all newly accepted projects until a further review indicates that the infrastructure, communications, and decision making process have stabilized in a manner consistent with other successful ASF projects. While incubation status is not necessarily a reflection of the completeness or stability of the code, it does indicate that the project has yet to be fully endorsed by the ASF. Copyright © 2020 The Apache Software Foundation. Licensed under the Apache License, Version 2.0. Apache Teaclave, Apache, the Apache feather, and the Apache Teaclave project logo are either trademarks or registered trademarks of the Apache Software Foundation.</div></div></div></div></footer></div>
</body>
</html>