<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-teaclave-trustzone-sdk/docs/emulate-and-dev-in-docker" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">🚀 Quick Start For QEMU Emulation | Apache Teaclave (incubating)</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://teaclave.apache.org/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://teaclave.apache.org/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://teaclave.apache.org/trustzone-sdk-docs/emulate-and-dev-in-docker.md"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="🚀 Quick Start For QEMU Emulation | Apache Teaclave (incubating)"><meta data-rh="true" name="description" content="This guide walks you through building and running QEMU emulation using the"><meta data-rh="true" property="og:description" content="This guide walks you through building and running QEMU emulation using the"><link data-rh="true" rel="canonical" href="https://teaclave.apache.org/trustzone-sdk-docs/emulate-and-dev-in-docker.md"><link data-rh="true" rel="alternate" href="https://teaclave.apache.org/trustzone-sdk-docs/emulate-and-dev-in-docker.md" hreflang="en"><link data-rh="true" rel="alternate" href="https://teaclave.apache.org/trustzone-sdk-docs/emulate-and-dev-in-docker.md" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Quick Emulation And Development in Docker","item":"https://teaclave.apache.org/trustzone-sdk-docs/emulate-and-dev-in-docker.md"}]}</script><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Apache Teaclave (incubating) RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Apache Teaclave (incubating) Atom Feed"><link rel="stylesheet" href="/assets/css/styles.c864e24f.css">
<script src="/assets/js/runtime~main.af65d8d3.js" defer="defer"></script>
<script src="/assets/js/main.fd7e90dd.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/img/logo.svg"><div role="region" aria-label="Skip to main content"><a class="skipToContent_G6ar" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="Apache Teaclave" class="themedComponent_DHUr themedComponent--light_DIHH" style="height:5.6rem;padding-left:1.6rem;position:relative;top:-1.8rem"><img src="/img/logo.svg" alt="Apache Teaclave" class="themedComponent_DHUr themedComponent--dark_Bv2M" style="height:5.6rem;padding-left:1.6rem;position:relative;top:-1.8rem"></div></a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/powered-by">Powered By</a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/community">Community</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/contributing">Contributing</a></li><li><a class="dropdown__link" href="/contributors">Contributors</a></li></ul></div><a class="navbar__item navbar__link" href="/download">Download</a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/docs">Docs</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/">Teaclave</a></li><li><a class="dropdown__link" href="/sgx-sdk-docs/">Teaclave SGX SDK</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/trustzone-sdk-docs/">Teaclave TrustZone SDK</a></li><li><a href="https://teaclave.apache.org/api-docs/sgx-sdk/" target="_self" rel="" class="dropdown__link">Teaclave SGX SDK<svg width="12" height="12" aria-hidden="true" class="iconExternalLink_awgD"><use href="#theme-svg-external-link"></use></svg></a></li><li><a href="https://teaclave.apache.org/api-docs/trustzone-sdk/optee-teec" target="_self" rel="" class="dropdown__link">Teaclave TrustZone SDK (Host)<svg width="12" height="12" aria-hidden="true" class="iconExternalLink_awgD"><use href="#theme-svg-external-link"></use></svg></a></li><li><a href="https://teaclave.apache.org/api-docs/trustzone-sdk/optee-utee" target="_self" rel="" class="dropdown__link">Teaclave TrustZone SDK (TA)<svg width="12" height="12" aria-hidden="true" class="iconExternalLink_awgD"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><a class="navbar__item navbar__link" href="/blog">Blog</a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Repos</a><ul class="dropdown__menu"><li><a href="https://github.com/apache/incubator-teaclave" target="_blank" rel="noopener noreferrer" class="dropdown__link">Teaclave<svg width="12" height="12" aria-hidden="true" class="iconExternalLink_awgD"><use href="#theme-svg-external-link"></use></svg></a></li><li><a href="https://github.com/apache/incubator-teaclave-sgx-sdk" target="_blank" rel="noopener noreferrer" class="dropdown__link">Teaclave SGX SDK<svg width="12" height="12" aria-hidden="true" class="iconExternalLink_awgD"><use href="#theme-svg-external-link"></use></svg></a></li><li><a href="https://github.com/apache/incubator-teaclave-trustzone-sdk" target="_blank" rel="noopener noreferrer" class="dropdown__link">Teaclave TrustZone SDK<svg width="12" height="12" aria-hidden="true" class="iconExternalLink_awgD"><use href="#theme-svg-external-link"></use></svg></a></li><li><a href="https://github.com/apache/incubator-teaclave-java-tee-sdk" target="_blank" rel="noopener noreferrer" class="dropdown__link">Teaclave Java TEE SDK<svg width="12" height="12" aria-hidden="true" class="iconExternalLink_awgD"><use href="#theme-svg-external-link"></use></svg></a></li><li><a href="https://github.com/apache/incubator-teaclave-website" target="_blank" rel="noopener noreferrer" class="dropdown__link">Teaclave Website<svg width="12" height="12" aria-hidden="true" class="iconExternalLink_awgD"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">ASF</a><ul class="dropdown__menu"><li><a href="https://www.apache.org/" target="_blank" rel="noopener noreferrer" class="dropdown__link">ASF Homepage<svg width="12" height="12" aria-hidden="true" class="iconExternalLink_awgD"><use href="#theme-svg-external-link"></use></svg></a></li><li><a href="https://www.apache.org/licenses/" target="_blank" rel="noopener noreferrer" class="dropdown__link">License<svg width="12" height="12" aria-hidden="true" class="iconExternalLink_awgD"><use href="#theme-svg-external-link"></use></svg></a></li><li><a href="https://www.apache.org/foundation/sponsorship.html" target="_blank" rel="noopener noreferrer" class="dropdown__link">Sponsorship<svg width="12" height="12" aria-hidden="true" class="iconExternalLink_awgD"><use href="#theme-svg-external-link"></use></svg></a></li><li><a href="https://www.apache.org/security/" target="_blank" rel="noopener noreferrer" class="dropdown__link">Security<svg width="12" height="12" aria-hidden="true" class="iconExternalLink_awgD"><use href="#theme-svg-external-link"></use></svg></a></li><li><a href="https://privacy.apache.org/policies/privacy-policy-public.html" target="_blank" rel="noopener noreferrer" class="dropdown__link">Privacy<svg width="12" height="12" aria-hidden="true" class="iconExternalLink_awgD"><use href="#theme-svg-external-link"></use></svg></a></li><li><a href="https://www.apache.org/foundation/thanks.html" target="_blank" rel="noopener noreferrer" class="dropdown__link">Thanks<svg width="12" height="12" aria-hidden="true" class="iconExternalLink_awgD"><use href="#theme-svg-external-link"></use></svg></a></li><li><a href="https://www.apache.org/events/current-event.html" target="_blank" rel="noopener noreferrer" class="dropdown__link">Events<svg width="12" height="12" aria-hidden="true" class="iconExternalLink_awgD"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="toggle_OLSw colorModeToggle_Hg9V"><button class="clean-btn toggleButton_wYmb toggleButtonDisabled_vaDU" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_KEbZ lightToggleIcon_Sxwe"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_KEbZ darkToggleIcon_Yem1"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_KEbZ systemToggleIcon_txm5"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_bmvg"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_UyTV"><div class="docsWrapper_XLvK"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_z1FD" type="button"></button><div class="docRoot_HciC"><aside class="theme-doc-sidebar-container docSidebarContainer_e5ai"><div class="sidebarViewport_N8x0"><div class="sidebar_vJCc"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_qiME"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/trustzone-sdk-docs/emulate-and-dev-in-docker.md">Teaclave TrustZone SDK Documentation</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/trustzone-sdk-docs/emulate-and-dev-in-docker.md">Quick Emulation And Development in Docker</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/trustzone-sdk-docs/emulate-and-dev-in-docker-std.md">Developing TAs with Rust Standard Library in Docker</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/trustzone-sdk-docs/overview-of-optee-rust-examples">Overview of OP-TEE Rust Examples</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/trustzone-sdk-docs/debugging-optee-ta.md">Debugging OP-TEE TA</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/trustzone-sdk-docs/expanding-ta-secure-memory-on-qemuv8.md">Expanding TA Secure Memory on QEMUv8</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/trustzone-sdk-docs/building-rust-ca-as-android-elf.md">Building Rust CA as Android ELF</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/trustzone-sdk-docs/writing-rust-tas-using-optee-utee-build.md">Writing Rust TAs using optee-utee-build</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/teaclave-trustzone-sdk/docs/advanced-setup">Advanced Setup</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/teaclave-trustzone-sdk/docs/ta-development-modes">TA Development Modes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/trustzone-sdk-docs/migrating-to-new-building-env.md">Migrating to New Building Environment</a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_namt"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_YAwJ"><div class="docItemContainer_Rv5Z"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_zCmv" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_JFrk"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Teaclave TrustZone SDK Documentation</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Quick Emulation And Development in Docker</span></li></ul></nav><div class="tocCollapsible_O_Qc theme-doc-toc-mobile tocMobile_tjDr"><button type="button" class="clean-btn tocCollapsibleButton_htYj">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>🚀 Quick Start For QEMU Emulation</h1></header>
<p>This guide walks you through building and running QEMU emulation using the
Teaclave TrustZone SDK.</p>
<p>We provide a Docker image with prebuilt QEMU and OP-TEE images to streamline
the entire Trusted Application (TA) development workflow. The image allows
developers to build TAs and emulate a guest virtual machine (VM) that includes
both the Normal World and Secure World environments.</p>
<h2 class="anchor anchorWithStickyNavbar_fF9Z" id="1-pull-development-docker-image">1. Pull Development Docker Image<a href="#1-pull-development-docker-image" class="hash-link" aria-label="Direct link to 1. Pull Development Docker Image" title="Direct link to 1. Pull Development Docker Image">​</a></h2>
<p><strong>Terminal A</strong> (Main development terminal):</p>
<div class="language-bash codeBlockContainer_ZGJx theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_kX1v"><pre tabindex="0" class="prism-code language-bash codeBlock_TAPP thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_AdAo"><span class="token-line" style="color:#393A34"><span class="token plain"># Pull the pre-built development environment</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ docker pull teaclave/teaclave-trustzone-emulator-nostd-optee-4.5.0-expand-memory:latest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Clone the repository</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ git clone https://github.com/apache/incubator-teaclave-trustzone-sdk.git &amp;&amp; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  cd incubator-teaclave-trustzone-sdk</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Launch the development container</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ docker run -it --rm \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --name teaclave_dev_env \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -v $(pwd):/root/teaclave_sdk_src \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -w /root/teaclave_sdk_src \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  teaclave/teaclave-trustzone-emulator-nostd-optee-4.5.0-expand-memory:latest</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_fF9Z" id="2-build-the-hello-world-example">2. Build the Hello World Example<a href="#2-build-the-hello-world-example" class="hash-link" aria-label="Direct link to 2. Build the Hello World Example" title="Direct link to 2. Build the Hello World Example">​</a></h2>
<p><strong>Still in Terminal A</strong> (inside the Docker container):</p>
<div class="language-bash codeBlockContainer_ZGJx theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_kX1v"><pre tabindex="0" class="prism-code language-bash codeBlock_TAPP thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_AdAo"><span class="token-line" style="color:#393A34"><span class="token plain"># Build the Hello World example (both CA and TA)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">make -C examples/hello_world-rs/</span><br></span></code></pre></div></div>
<p>Under the hood, the Makefile builds both the Trusted Application (TA) and the
Host Application separately. After a successful build, you&#x27;ll find the
resulting binaries in the <code>hello_world-rs</code> directory:</p>
<div class="language-bash codeBlockContainer_ZGJx theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_kX1v"><pre tabindex="0" class="prism-code language-bash codeBlock_TAPP thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_AdAo"><span class="token-line" style="color:#393A34"><span class="token plain">TA=ta/target/aarch64-unknown-linux-gnu/release/133af0ca-bdab-11eb-9130-43bf7873bf67.ta</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">HOST_APP=host/target/aarch64-unknown-linux-gnu/release/hello_world-rs</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_fF9Z" id="3-make-the-artifacts-accessible-to-the-emulator">3. Make the Artifacts Accessible to the Emulator<a href="#3-make-the-artifacts-accessible-to-the-emulator" class="hash-link" aria-label="Direct link to 3. Make the Artifacts Accessible to the Emulator" title="Direct link to 3. Make the Artifacts Accessible to the Emulator">​</a></h2>
<p>After building the Hello World example, the next step is to make the compiled
artifacts accessible to the emulator.</p>
<p>There are <strong>two approaches</strong> to do this. You can choose either based on your
preference:</p>
<ul>
<li>📦 <strong>Manual sync</strong>: Explicitly sync host and TA binaries to the emulator</li>
<li>⚙️ <strong>Makefile integration</strong>: Use <code>make emulate</code> to build and sync in one step</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_fF9Z" id="option-1-manual-sync-via-sync_to_emulator">Option 1: Manual Sync via <code>sync_to_emulator</code><a href="#option-1-manual-sync-via-sync_to_emulator" class="hash-link" aria-label="Direct link to option-1-manual-sync-via-sync_to_emulator" title="Direct link to option-1-manual-sync-via-sync_to_emulator">​</a></h4>
<p>We provide a helper command called <code>sync_to_emulator</code>, which simplifies the
process of syncing the build outputs to the emulation environment.
Run the following commands inside the container:</p>
<div class="language-bash codeBlockContainer_ZGJx theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_kX1v"><pre tabindex="0" class="prism-code language-bash codeBlock_TAPP thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_AdAo"><span class="token-line" style="color:#393A34"><span class="token plain">sync_to_emulator --ta $TA</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sync_to_emulator --host $HOST_APP</span><br></span></code></pre></div></div>
<p>Run <code>sync_to_emulator -h</code> for more usage options.</p>
<h4 class="anchor anchorWithStickyNavbar_fF9Z" id="option-2-integrate-sync-with-tas-makefile">Option 2: Integrate sync with TA&#x27;s Makefile<a href="#option-2-integrate-sync-with-tas-makefile" class="hash-link" aria-label="Direct link to Option 2: Integrate sync with TA&#x27;s Makefile" title="Direct link to Option 2: Integrate sync with TA&#x27;s Makefile">​</a></h4>
<p>For convenience during daily development, the sync invocation can be integrated into
the Makefile. In the <code>hello_world-rs</code> example, an <code>emulate</code> target is provided.
This helps automatically build the artifacts and sync them to the emulator in one step:</p>
<div class="language-bash codeBlockContainer_ZGJx theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_kX1v"><pre tabindex="0" class="prism-code language-bash codeBlock_TAPP thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_AdAo"><span class="token-line" style="color:#393A34"><span class="token plain">make -C examples/hello_world-rs/ emulate</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_fF9Z" id="4-multi-terminal-execution">4. Multi-Terminal Execution<a href="#4-multi-terminal-execution" class="hash-link" aria-label="Direct link to 4. Multi-Terminal Execution" title="Direct link to 4. Multi-Terminal Execution">​</a></h2>
<p>The emulation workflow requires three additional terminals to monitor
various aspects of the system:</p>
<ul>
<li><strong>Terminal B</strong>: 🖥️ <strong>Normal World Listener</strong> - Provides access to the guest VM shell</li>
<li><strong>Terminal C</strong>: 🔒 <strong>Secure World Listener</strong> - Monitors Trusted Application output logs</li>
<li><strong>Terminal D</strong>: 🚀 <strong>QEMU Control</strong> - Controls the QEMU emulator</li>
</ul>
<p>Built-in commands are provided in the Docker image. These commands are located
in <code>/opt/teaclave/bin/</code> and are included in the default user&#x27;s $PATH.</p>
<p>You may use <code>bash -l</code> or the full path when executing with docker exec.</p>
<p><strong>Terminal B</strong> (Guest VM Shell):</p>
<div class="language-bash codeBlockContainer_ZGJx theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_kX1v"><pre tabindex="0" class="prism-code language-bash codeBlock_TAPP thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_AdAo"><span class="token-line" style="color:#393A34"><span class="token plain"># Connect to the guest VM shell for running commands inside the emulated environment</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ docker exec -it teaclave_dev_env bash -l -c listen_on_guest_vm_shell</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Alternative: Use full path</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ docker exec -it teaclave_dev_env /opt/teaclave/bin/listen_on_guest_vm_shell</span><br></span></code></pre></div></div>
<p><strong>Terminal C</strong> (Secure World Output Monitor):</p>
<div class="language-bash codeBlockContainer_ZGJx theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_kX1v"><pre tabindex="0" class="prism-code language-bash codeBlock_TAPP thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_AdAo"><span class="token-line" style="color:#393A34"><span class="token plain"># Monitor Trusted Application output logs in real-time</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ docker exec -it teaclave_dev_env bash -l -c listen_on_secure_world_log</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Alternative: Use full path  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ docker exec -it teaclave_dev_env /opt/teaclave/bin/listen_on_secure_world_log</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_fF9Z" id="5-start-the-emulation">5. Start the Emulation<a href="#5-start-the-emulation" class="hash-link" aria-label="Direct link to 5. Start the Emulation" title="Direct link to 5. Start the Emulation">​</a></h2>
<p>After the listeners are set up, we can start the QEMU emulator.</p>
<p><strong>Terminal D</strong> (QEMU Control):</p>
<div class="language-bash codeBlockContainer_ZGJx theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_kX1v"><pre tabindex="0" class="prism-code language-bash codeBlock_TAPP thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_AdAo"><span class="token-line" style="color:#393A34"><span class="token plain"># Launch QEMU emulator with debug output and connect to monitoring ports</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ docker exec -it teaclave_dev_env bash -l -c &quot;LISTEN_MODE=ON start_qemuv8&quot;</span><br></span></code></pre></div></div>
<blockquote>
<p>⏳ <strong>Wait for the QEMU environment to fully boot...</strong>
You should see boot messages in Terminal D and the guest VM shell prompt
in Terminal B.</p>
</blockquote>
<p>After QEMU in Terminal D successfully launches, switch to Terminal B, which
provides shell access to the guest VM&#x27;s normal world.</p>
<p><strong>Terminal B</strong> (Inside Guest VM):
From this shell, you&#x27;ll find that the artifacts synced in <strong>Step 3</strong> are already
available in the current working directory. Additionally, the <code>ta/</code> and
<code>plugin/</code> subdirectories are automatically mounted to be used by TEE OS during
TA execution and plugin loading.</p>
<p>For more details on the mount configuration, refer to the
<code>listen_on_guest_vm_shell</code> command in the development environment.</p>
<div class="language-bash codeBlockContainer_ZGJx theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_kX1v"><pre tabindex="0" class="prism-code language-bash codeBlock_TAPP thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_AdAo"><span class="token-line" style="color:#393A34"><span class="token plain"># tree</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|-- host</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|   `-- hello_world-rs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|-- plugin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">`-- ta</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    `-- 133af0ca-bdab-11eb-9130-43bf7873bf67.ta</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">3 directories, 2 files</span><br></span></code></pre></div></div>
<p>This makes it especially convenient for iterative development and frequent code
updates.</p>
<p>Now we are ready to interact with the TA from normal world shell.</p>
<div class="language-bash codeBlockContainer_ZGJx theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_kX1v"><pre tabindex="0" class="prism-code language-bash codeBlock_TAPP thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_AdAo"><span class="token-line" style="color:#393A34"><span class="token plain"># Execute the Hello World Client Application</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ ./host/hello_world-rs</span><br></span></code></pre></div></div>
<p>The secure world logs, including TA debug messages, are displayed in <strong>Terminal C</strong>.</p>
<h2 class="anchor anchorWithStickyNavbar_fF9Z" id="6-iterative-development-with-frequent-code-updates-and-execution">6. Iterative Development with Frequent Code Updates and Execution<a href="#6-iterative-development-with-frequent-code-updates-and-execution" class="hash-link" aria-label="Direct link to 6. Iterative Development with Frequent Code Updates and Execution" title="Direct link to 6. Iterative Development with Frequent Code Updates and Execution">​</a></h2>
<p>During active development and debugging, you can leave Terminals B, C, and D open to
avoid restarting them each time. Simply return to Terminal A, and repeat Step 2 (build)
and Step 3 (sync) to rebuild and update the artifacts. Once synced, switch to
Terminal B to re-run the client application. This setup streamlines iterative
development and testing.</p>
<h2 class="anchor anchorWithStickyNavbar_fF9Z" id="summary">Summary<a href="#summary" class="hash-link" aria-label="Direct link to Summary" title="Direct link to Summary">​</a></h2>
<p>By following this guide, you can emulate and debug Trusted Applications using our
pre-configured Docker-based development environment.</p>
<ul>
<li><strong>Terminal A</strong> serves as the main interface for building and syncing artifacts.</li>
<li><strong>Terminal B</strong> gives access to the normal world inside the guest VM, where you
can run client applications like the Hello World example.</li>
<li><strong>Terminal C</strong> captures logs and debug output from the secure world, making it
easy to trace TA behavior.</li>
<li><strong>Terminal D</strong> controls the QEMU emulator and shows system-level logs during
boot and runtime.</li>
</ul>
<p>Together, these terminals provide a complete and efficient workflow for TrustZone
development and emulation.</p>
<h3 class="anchor anchorWithStickyNavbar_fF9Z" id="development-environment-details">Development Environment Details<a href="#development-environment-details" class="hash-link" aria-label="Direct link to Development Environment Details" title="Direct link to Development Environment Details">​</a></h3>
<p>The setup scripts and built-in commands can be found in <code>/opt/teaclave/</code>. Please
refer to the Dockerfile in the SDK source repository for more information about
how we set up the development environment.</p></div></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--next" href="/trustzone-sdk-docs/emulate-and-dev-in-docker-std.md"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Developing TAs with Rust Standard Library in Docker</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_TN1Q thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#1-pull-development-docker-image" class="table-of-contents__link toc-highlight">1. Pull Development Docker Image</a></li><li><a href="#2-build-the-hello-world-example" class="table-of-contents__link toc-highlight">2. Build the Hello World Example</a></li><li><a href="#3-make-the-artifacts-accessible-to-the-emulator" class="table-of-contents__link toc-highlight">3. Make the Artifacts Accessible to the Emulator</a></li><li><a href="#4-multi-terminal-execution" class="table-of-contents__link toc-highlight">4. Multi-Terminal Execution</a></li><li><a href="#5-start-the-emulation" class="table-of-contents__link toc-highlight">5. Start the Emulation</a></li><li><a href="#6-iterative-development-with-frequent-code-updates-and-execution" class="table-of-contents__link toc-highlight">6. Iterative Development with Frequent Code Updates and Execution</a></li><li><a href="#summary" class="table-of-contents__link toc-highlight">Summary</a><ul><li><a href="#development-environment-details" class="table-of-contents__link toc-highlight">Development Environment Details</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright"><div style="font-size:.7rem; text-align:left;">Apache Teaclave (incubating) is an effort undergoing incubation at The Apache Software Foundation (ASF), sponsored by the Apache Incubator. Incubation is required of all newly accepted projects until a further review indicates that the infrastructure, communications, and decision making process have stabilized in a manner consistent with other successful ASF projects. While incubation status is not necessarily a reflection of the completeness or stability of the code, it does indicate that the project has yet to be fully endorsed by the ASF. Copyright © 2020 The Apache Software Foundation. Licensed under the Apache License, Version 2.0. Apache Teaclave, Apache, the Apache feather, and the Apache Teaclave project logo are either trademarks or registered trademarks of the Apache Software Foundation.</div></div></div></div></footer></div>
</body>
</html>